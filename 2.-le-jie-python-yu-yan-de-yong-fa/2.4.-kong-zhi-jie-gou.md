# 2.4. 控制结构

程序的控制结构有循环、选择结构。

选择是根据条件决定执行哪一段程序，可以用if类型的语句控制。

回顾“面向对象”部分的sequence函数，我们已经遇到过if语句，基本形式如下

```
if cond1:
    action1()
action2()
```

cond1是一个布尔型变量，如果值为真，则执行程序片段action1，如果值为假，则不执行；无论值如何，都将继续执行选择结构外的action2. Python语言通过缩进确定选择体的范围：**处于选择结构中的程序片段，在语句前加入4个空格。**

{% hint style="info" %}
一个Python脚本中可以统一使用2个及以上任意数量的空格、制表符表示缩进，一个脚本中缩进的形式必须统一，制表符和空格不可混用。按照开发者规范，通常使用4个空格表示缩进。
{% endhint %}

if语句可以嵌套使用：

```
if cond1:
    action1()
    if cond2:
        action2()
    action3()
action4()
```

如果在cond1不满足时，需要运行另一段程序片段，则可以写作：

```
if cond1:
    action1()
else:
    action2()
action3()
```

此时cond1为真则执行action1，为假则执行action2，action1与action2不会同时被执行。无论cond1为什么情况，都会执行action3.

如果需要连续地判断多个条件是否成立，可以使用elif语句：

```
if cond1:
    action1()
elif cond2:
    action2()
elif cond3:
    action3()
else:
    action4()
```

如果cond1为真，则执行action1，否则判断cond2是否为真。如果cond2为真，则执行action2，否则判断cond3是否为真。如果cond3为真，则执行action3，否则执行action4.

循环是重复执行一段程序语句，可以用while语句或for语句控制。sequence函数可以被改写成while函数的形式：

```
a = 1
b = 1
while b < 1000:
    print(f'{a} + {b} = {a + b}')
    a, b = b, a + b
```

在循环执行前，检查b<1000是否为真。如为假，则跳过循环执行后面的语句；如为真，则执行一次循环体，执行完后再次判断条件。

while循环适合按照条件确定循环次数的情况，而for循环更适合遍历情况：

```
for x in range(3, 6):
    print(x ** 2)
```

其中range是一个类，通常把它当作一个函数使用（它内置了\_\_call\_\_方法），有3个形式参数：左端点、右端点、步长，都只接受整数类型的实际参数。当传入1个实际参数时，填入右端点，而左端点等于0，步长等于1. 当传入2个实际参数时，依次填入左端点和右端点，而步长等于1. 如果左端点大于或等于右端点，则返回空的列表。如果传入3个参数，则依次填入左端点、右端点、步长。

{% hint style="info" %}
列表是一种数据结构，将在“数据结构”部分介绍。为了理解range类的特性，我们用list函数将range的输出转换成列表。

**生成器：**一种特殊的类，内部包含一个迭代规则。生成器的实例会记住最后输出的数值，在每次被调用时，会通过next方法，按照迭代规则输出下一个数值，通常仅用于for循环。range就是一个生成器，可以使用list函数一次性获取生成器的所有输出。
{% endhint %}

我们用一些例子了解range类的特性：

```
>>> list(range(5))
[0, 1, 2, 3, 4]
>>> list(range(5, 5))
[]
>>> list(range(5, 7))
[5, 6]
>>> list(range(5, 8, 3))
[5]
>>> list(range(5, 9, 3))
[5, 8]
```

记左端点a，右端点b，步长s. range类的输出可以看作数列

$$
{a, a+s, a+2s, ..., a+ns}, n\in Z^+, a + ns < b
$$

在上面的例子中，输出的x\*\*2依次是9, 16, 25. 特别注意，range类不会包括右端点。

特别地，break语句可以中途退出循环，continue语句可以停止当前循环，立即进入下一个循环，例如

```
for i in range(5):
    if i == 3:
        break
    if i == 1:
        continue
    print(i)
```

程序的输出依次是0, 2.

此处的range也可以替换成一个类似列表的变量，for循环会依次将列表的一个值赋给i，结束一次循环后，再将列表的下一个值赋给i. 列表的使用方法将在“数据结构”部分介绍。
